<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover, user-scalable=no">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="default">
<meta name="apple-mobile-web-app-title" content="Espa√±a 2026">
<meta name="theme-color" content="#ffffff">
<title>Espa√±a 2026</title>
<link rel="apple-touch-icon" href="icon-180.png">
<link rel="icon" type="image/png" href="icon-180.png">

<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-database-compat.js"></script>

<style>
  @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap');
  * { margin:0; padding:0; box-sizing:border-box; -webkit-tap-highlight-color:transparent; }

  :root {
    --safe-top: env(safe-area-inset-top, 20px);
    --safe-bottom: env(safe-area-inset-bottom, 0px);
    --red: #D71920; --red-light: #ff2d35; --red-soft: #ffe5e6;
    --blue: #1B3C8C; --blue-light: #2952c4; --blue-soft: #e6ecfa;
    --white: #ffffff;
    --bg: #f2f4f8; --card: #ffffff; --text: #0d1117; --dim: #636c76;
    --border: rgba(0,0,0,0.06);
    --r: 20px;
  }

  body {
    font-family: 'Inter', -apple-system, system-ui, sans-serif;
    background: var(--bg); color: var(--text);
    min-height: 100dvh; overflow-x: hidden;
    -webkit-font-smoothing: antialiased;
  }

  /* ====== SYNC PILL ====== */
  .sync {
    position: fixed; top: calc(var(--safe-top) + 6px); left: 50%; transform: translateX(-50%);
    z-index: 200; padding: 5px 14px; border-radius: 20px;
    font-size: 11px; font-weight: 700; letter-spacing: 0.4px;
    backdrop-filter: blur(16px); -webkit-backdrop-filter: blur(16px);
    animation: fadeDown 0.5s cubic-bezier(0.16,1,0.3,1);
  }
  @keyframes fadeDown { from{opacity:0;transform:translateX(-50%) translateY(-12px)} to{opacity:1;transform:translateX(-50%) translateY(0)} }
  .sync.on { background: rgba(215,25,32,0.12); color: var(--red); border: 1px solid rgba(215,25,32,0.15); }
  .sync.off { background: rgba(27,60,140,0.1); color: var(--blue); border: 1px solid rgba(27,60,140,0.12); }

  /* ====== HEADER ====== */
  .header {
    padding: calc(var(--safe-top) + 48px) 20px 20px;
    background: var(--blue);
    position: relative; overflow: hidden;
  }
  .header::before {
    content: ''; position: absolute; top: 0; left: 0; right: 0; bottom: 0;
    background:
      radial-gradient(ellipse at 20% 50%, rgba(215,25,32,0.15) 0%, transparent 60%),
      radial-gradient(ellipse at 80% 20%, rgba(255,255,255,0.08) 0%, transparent 50%);
  }
  .header::after {
    content: ''; position: absolute; bottom: 0; left: 0; right: 0; height: 3px;
    background: linear-gradient(90deg, var(--red), var(--white) 50%, var(--red));
  }
  .header-inner { position: relative; z-index: 1; display: flex; align-items: center; gap: 14px; }

  /* Nacional Shield SVG */
  .shield { width: 50px; height: 56px; flex-shrink: 0; filter: drop-shadow(0 2px 8px rgba(0,0,0,0.3)); overflow: hidden; }

  .header-text { flex: 1; }
  .header h1 {
    font-size: 26px; font-weight: 900; color: #fff;
    letter-spacing: -0.5px; line-height: 1.1;
  }
  .header h1 .yr { color: var(--red-light); font-weight: 900; }
  .header .sub { font-size: 13px; color: rgba(255,255,255,0.6); font-weight: 500; margin-top: 4px; }

  .share-btn {
    width: 40px; height: 40px; border-radius: 12px; border: 1px solid rgba(255,255,255,0.15);
    background: rgba(255,255,255,0.1); color: #fff; font-size: 16px; cursor: pointer;
    display: flex; align-items: center; justify-content: center;
    backdrop-filter: blur(8px); transition: all 0.15s;
  }
  .share-btn:active { transform: scale(0.9); background: rgba(255,255,255,0.2); }

  /* City summary strip */
  .city-strip {
    display: flex; gap: 2px; margin-top: 14px; border-radius: 10px; overflow: hidden;
  }
  .city-bar {
    height: 32px; display: flex; align-items: center; justify-content: center;
    font-size: 10px; font-weight: 700; color: #fff; letter-spacing: 0.3px;
    text-shadow: 0 1px 2px rgba(0,0,0,0.3);
    transition: flex 0.3s ease;
  }

  /* ====== FILTER TABS ====== */
  .tabs {
    display: flex; gap: 6px; padding: 14px 16px 6px;
    overflow-x: auto; scrollbar-width: none;
  }
  .tabs::-webkit-scrollbar { display: none; }
  .tab {
    flex-shrink: 0; padding: 7px 16px; border-radius: 10px;
    border: none; background: var(--card);
    color: var(--dim); font-size: 13px; font-weight: 600;
    cursor: pointer; transition: all 0.2s; font-family: inherit;
    box-shadow: 0 1px 3px rgba(0,0,0,0.04);
  }
  .tab.on {
    background: var(--blue); color: #fff;
    box-shadow: 0 3px 10px rgba(27,60,140,0.25);
  }

  /* ====== CALENDAR ====== */
  .cal-wrap { padding: 6px 12px; }
  .cal {
    background: var(--card); border-radius: var(--r); padding: 16px;
    box-shadow: 0 1px 4px rgba(0,0,0,0.04);
  }
  .cal-head {
    display: flex; align-items: center; justify-content: center; gap: 8px;
    margin-bottom: 12px;
  }
  .cal-month { font-size: 15px; font-weight: 800; color: var(--blue); letter-spacing: -0.2px; }
  .cal-dot { width: 5px; height: 5px; border-radius: 50%; background: var(--red); }
  .cal-wk {
    display: grid; grid-template-columns: repeat(7,1fr);
    text-align: center; margin-bottom: 4px;
  }
  .cal-wk span { font-size: 10px; font-weight: 800; color: var(--dim); text-transform: uppercase; letter-spacing: 0.8px; }
  .cal-g { display: grid; grid-template-columns: repeat(7,1fr); gap: 4px; }
  .cd {
    aspect-ratio: 1; display: flex; flex-direction: column;
    align-items: center; justify-content: center;
    border-radius: 12px; font-size: 14px; font-weight: 700;
    cursor: pointer; transition: all 0.15s ease; position: relative;
    -webkit-user-select: none; user-select: none;
  }
  .cd.x { color: #ccd0d5; cursor: default; }
  .cd.t { color: #fff; }
  .cd.t:active { transform: scale(0.85); }
  .cd.sel {
    transform: scale(1.18); z-index: 2;
    box-shadow: 0 0 0 2.5px var(--red), 0 6px 16px rgba(215,25,32,0.3);
  }
  .dots { display: flex; gap: 2px; margin-top: 1px; }
  .dot { width: 3px; height: 3px; border-radius: 50%; background: rgba(255,255,255,0.6); }

  /* ====== DAY DETAIL ====== */
  .det-wrap { padding: 6px 12px 120px; }
  .det {
    background: var(--card); border-radius: var(--r); overflow: hidden;
    box-shadow: 0 1px 4px rgba(0,0,0,0.04);
    animation: slideUp 0.35s cubic-bezier(0.16,1,0.3,1);
  }
  @keyframes slideUp { from{opacity:0;transform:translateY(24px)} to{opacity:1;transform:translateY(0)} }

  .det-banner {
    padding: 18px 18px 14px; display: flex; align-items: center; gap: 12px;
    position: relative; overflow: hidden;
  }
  .det-banner::before {
    content: ''; position: absolute; inset: 0;
    opacity: 0.06;
  }
  .det-ico {
    width: 48px; height: 48px; border-radius: 14px;
    display: flex; align-items: center; justify-content: center;
    font-size: 24px; background: rgba(255,255,255,0.9);
    box-shadow: 0 2px 8px rgba(0,0,0,0.06);
    position: relative; z-index: 1;
  }
  .det-info { position: relative; z-index: 1; }
  .det-name { font-size: 18px; font-weight: 800; color: var(--text); letter-spacing: -0.3px; }
  .det-badge {
    display: inline-flex; align-items: center; gap: 4px;
    font-size: 11px; font-weight: 700; padding: 2px 8px;
    border-radius: 6px; color: #fff; margin-top: 3px;
  }

  /* Events list */
  .evs { padding: 4px 0; }
  .ev {
    display: flex; align-items: flex-start; padding: 12px 18px; gap: 12px;
    transition: background 0.1s;
  }
  .ev:active { background: var(--bg); }
  .ev-ic {
    width: 38px; height: 38px; border-radius: 11px;
    display: flex; align-items: center; justify-content: center;
    font-size: 16px; flex-shrink: 0;
  }
  .ev-ic.flight { background: var(--blue-soft); }
  .ev-ic.transport { background: #f0f2f5; }
  .ev-ic.tourism { background: var(--red-soft); }
  .ev-ic.food { background: #fef3c7; }
  .ev-ic.f1 { background: linear-gradient(135deg, var(--red-soft), #ffd6d8); }
  .ev-nfo { flex: 1; min-width: 0; }
  .ev-t { font-size: 10px; font-weight: 700; color: var(--red); letter-spacing: 0.5px; text-transform: uppercase; }
  .ev-n { font-size: 14px; font-weight: 700; color: var(--text); margin-top: 1px; }
  .ev-d { font-size: 12px; color: var(--dim); margin-top: 1px; }
  .ev-x {
    background: none; border: none; color: var(--dim); font-size: 16px;
    cursor: pointer; padding: 4px 6px; border-radius: 8px; opacity: 0.3;
    flex-shrink: 0; transition: all 0.15s;
  }
  .ev-x:active { opacity: 1; color: var(--red); background: var(--red-soft); }
  .ev-sep { height: 1px; background: var(--border); margin: 0 18px 0 68px; }

  /* Add event */
  .add-b {
    display: flex; align-items: center; justify-content: center; gap: 5px;
    padding: 12px; color: var(--blue); font-size: 13px; font-weight: 700;
    cursor: pointer; border: none; background: none; width: 100%;
    font-family: inherit; transition: background 0.15s;
    border-top: 1px solid var(--border);
  }
  .add-b:active { background: var(--blue-soft); }
  .add-f {
    padding: 14px 18px 18px; border-top: 1px solid var(--border);
    animation: slideUp 0.2s ease;
  }
  .fr { display: flex; gap: 6px; margin-bottom: 6px; }
  .fi {
    background: var(--bg); border: 1.5px solid var(--border);
    border-radius: 10px; padding: 10px 12px; font-size: 14px;
    font-family: inherit; color: var(--text); outline: none; width: 100%;
    transition: border-color 0.2s, box-shadow 0.2s;
  }
  .fi:focus { border-color: var(--blue); box-shadow: 0 0 0 3px rgba(27,60,140,0.1); }
  .fi::placeholder { color: #b0b5bf; }
  .fi.tm { width: 72px; flex-shrink: 0; }
  .fs {
    background: var(--bg); border: 1.5px solid var(--border);
    border-radius: 10px; padding: 10px 12px; font-size: 14px;
    font-family: inherit; color: var(--text); outline: none;
  }
  .fa { display: flex; gap: 6px; margin-top: 4px; }
  .btn-add {
    background: var(--red); color: #fff; border: none;
    padding: 11px 18px; border-radius: 10px; font-size: 14px;
    font-weight: 700; cursor: pointer; flex: 1; font-family: inherit;
    box-shadow: 0 3px 10px rgba(215,25,32,0.2);
    transition: transform 0.15s;
  }
  .btn-add:active { transform: scale(0.97); }
  .btn-cancel {
    background: var(--bg); color: var(--dim); border: 1.5px solid var(--border);
    padding: 11px 18px; border-radius: 10px; font-size: 14px;
    font-weight: 600; cursor: pointer; font-family: inherit;
  }

  /* Hint */
  .hint { text-align: center; padding: 40px 20px; color: var(--dim); }
  .hint-shield { width: 46px; height: 56px; margin: 0 auto 12px; opacity: 0.15; }
  .hint-t { font-size: 14px; font-weight: 500; line-height: 1.5; }

  /* Modal */
  .mbg {
    position: fixed; inset: 0; background: rgba(0,0,0,0.5);
    backdrop-filter: blur(6px); -webkit-backdrop-filter: blur(6px);
    z-index: 300; display: flex; align-items: flex-end;
    justify-content: center; animation: fadein .2s;
  }
  @keyframes fadein { from{opacity:0} to{opacity:1} }
  .msh {
    background: #fff; border-radius: 24px 24px 0 0;
    padding: 24px 20px calc(var(--safe-bottom) + 24px);
    width: 100%; max-width: 420px;
    animation: sheetUp .3s cubic-bezier(0.16,1,0.3,1);
  }
  @keyframes sheetUp { from{transform:translateY(100%)} to{transform:translateY(0)} }
  .msh h2 { font-size: 20px; font-weight: 800; color: var(--blue); margin-bottom: 4px; }
  .msh p { color: var(--dim); font-size: 13px; margin-bottom: 14px; line-height: 1.5; }
  .sbox {
    background: var(--bg); border-radius: 12px; padding: 12px;
    display: flex; align-items: center; gap: 8px; margin-bottom: 14px;
  }
  .sbox span { flex: 1; color: var(--blue); font-size: 11px; font-family: ui-monospace, monospace; word-break: break-all; }
  .cpb {
    background: var(--red); color: #fff; border: none;
    padding: 7px 14px; border-radius: 8px; font-size: 12px;
    font-weight: 700; cursor: pointer; flex-shrink: 0;
  }
  .clb {
    background: var(--bg); color: var(--dim); border: none;
    padding: 12px; border-radius: 12px; width: 100%;
    font-size: 15px; font-weight: 600; cursor: pointer; font-family: inherit;
  }

  .spacer { height: calc(var(--safe-bottom) + 20px); }

  /* ===== F1 Splash Animation ===== */
  .splash {
    position: fixed; inset: 0; z-index: 9999;
    background: linear-gradient(135deg, var(--blue) 0%, #0f1d33 100%);
    display: flex; flex-direction: column; align-items: center; justify-content: center;
    transition: opacity 0.5s ease, transform 0.5s ease;
    overflow: hidden;
  }
  .splash.hide { opacity: 0; transform: scale(1.05); pointer-events: none; }
  .splash::before, .splash::after {
    content: ''; position: absolute; left: 0; right: 0; height: 2px;
    background: repeating-linear-gradient(90deg, rgba(255,255,255,0.1) 0px, rgba(255,255,255,0.1) 20px, transparent 20px, transparent 40px);
  }
  .splash::before { top: 38%; }
  .splash::after { bottom: 38%; }
  .speed-lines { position: absolute; inset: 0; overflow: hidden; }
  .speed-line {
    position: absolute; height: 1px; background: linear-gradient(90deg, transparent, rgba(215,25,32,0.4), transparent);
    animation: speedLine 0.8s linear infinite;
  }
  @keyframes speedLine { 0%{transform:translateX(-100%)} 100%{transform:translateX(200vw)} }
  .f1-car-wrap {
    position: relative; z-index: 2;
    animation: carEntry 1.2s cubic-bezier(0.16,1,0.3,1) forwards;
  }
  @keyframes carEntry {
    0%{transform:translateX(-120vw) scale(0.8);opacity:0} 40%{opacity:1}
    70%{transform:translateX(0) scale(1)} 85%{transform:translateX(10px) scale(1)}
    100%{transform:translateX(0) scale(1);opacity:1}
  }
  .f1-car { font-size: 72px; filter: drop-shadow(0 0 30px rgba(215,25,32,0.5)); animation: carBounce 0.6s ease-in-out infinite alternate; animation-delay: 1.2s; }
  @keyframes carBounce { 0%{transform:translateY(0)} 100%{transform:translateY(-3px)} }
  .smoke {
    position: absolute; bottom: -10px; left: -60px;
    width: 80px; height: 30px; border-radius: 50%;
    background: radial-gradient(ellipse, rgba(255,255,255,0.3), transparent);
    animation: smokeAnim 1s ease-out forwards; animation-delay: 0.8s; opacity: 0;
  }
  @keyframes smokeAnim { 0%{opacity:0;transform:scale(0.5) translateX(0)} 50%{opacity:0.6} 100%{opacity:0;transform:scale(2) translateX(-40px)} }
  .splash-title {
    position: relative; z-index: 2; margin-top: 28px; text-align: center;
    animation: titleReveal 0.6s cubic-bezier(0.16,1,0.3,1) forwards;
    animation-delay: 0.7s; opacity: 0; transform: translateY(20px);
  }
  @keyframes titleReveal { to{opacity:1;transform:translateY(0)} }
  .splash-title h2 { font-size: 32px; font-weight: 900; color: #fff; letter-spacing: -1px; text-shadow: 0 2px 20px rgba(0,0,0,0.3); }
  .splash-title h2 .red { color: var(--red); }
  .splash-title .year { font-size: 14px; font-weight: 600; color: rgba(255,255,255,0.5); letter-spacing: 6px; margin-top: 6px; text-transform: uppercase; }
  .checkered {
    position: absolute; bottom: 0; left: 0; right: 0; height: 24px;
    display: flex; flex-wrap: wrap;
    animation: checkReveal 0.4s ease forwards; animation-delay: 1s; opacity: 0;
  }
  @keyframes checkReveal { to{opacity:1} }
  .checkered span { width: 12px; height: 12px; display: inline-block; }
  .splash-dots {
    position: relative; z-index: 2; margin-top: 20px;
    display: flex; gap: 6px;
    animation: titleReveal 0.5s ease forwards; animation-delay: 1s; opacity: 0;
  }
  .splash-dots span { width: 6px; height: 6px; border-radius: 50%; background: var(--red); animation: dotPulse 1s ease infinite; }
  .splash-dots span:nth-child(2) { animation-delay: 0.2s; }
  .splash-dots span:nth-child(3) { animation-delay: 0.4s; }
  @keyframes dotPulse { 0%,80%,100%{opacity:0.3;transform:scale(0.8)} 40%{opacity:1;transform:scale(1.2)} }
</style>
</head>
<body>
<div id="splash" class="splash">
  <div class="speed-lines">
    <div class="speed-line" style="top:20%;width:40%;animation-delay:0.1s;animation-duration:0.7s"></div>
    <div class="speed-line" style="top:35%;width:60%;animation-delay:0.3s;animation-duration:0.6s"></div>
    <div class="speed-line" style="top:50%;width:35%;animation-delay:0s;animation-duration:0.8s"></div>
    <div class="speed-line" style="top:65%;width:50%;animation-delay:0.2s;animation-duration:0.65s"></div>
    <div class="speed-line" style="top:80%;width:45%;animation-delay:0.4s;animation-duration:0.75s"></div>
  </div>
  <div class="f1-car-wrap">
    <div class="f1-car">üèéÔ∏è</div>
    <div class="smoke"></div>
  </div>
  <div class="splash-title">
    <h2>Espa√±a <span class="red">F1</span></h2>
    <div class="year">Junio 2026</div>
  </div>
  <div class="splash-dots"><span></span><span></span><span></span></div>
  <div class="checkered" id="checkered"></div>
</div>
<div id="app"></div>
<script>
// Nacional shield ‚Äî embedded as base64 PNG
const SHIELD_B64='data:image/png;base64,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';
const SHIELD_SVG=`<img src="${SHIELD_B64}" alt="Nacional" style="width:100%;height:100%;object-fit:contain">`;
const SHIELD_HINT=SHIELD_SVG;

const TRIP=[
  {date:"2026-06-05",label:"Viernes 5",city:"Vuelo",color:"#6366f1",icon:"‚úàÔ∏è",events:[{time:"21:45",title:"Vuelo a Madrid",detail:"IB 170 ‚Äî Salida 9:45pm",type:"flight"}]},
  {date:"2026-06-06",label:"S√°bado 6",city:"Madrid",color:"#D71920",icon:"üè∞",events:[{time:"üåÖ",title:"Llegada a Madrid",detail:"Check-in y descanso",type:"transport"},{time:"üåÜ",title:"Paseo por el centro",detail:"Puerta del Sol, Plaza Mayor",type:"tourism"}]},
  {date:"2026-06-07",label:"Domingo 7",city:"Madrid",color:"#D71920",icon:"üè∞",events:[{time:"üåÖ",title:"Museo del Prado",detail:"Reservar entrada online",type:"tourism"},{time:"üåÜ",title:"Parque del Retiro",detail:"Paseo y Palacio de Cristal",type:"tourism"}]},
  {date:"2026-06-08",label:"Lunes 8",city:"Madrid",color:"#D71920",icon:"üè∞",events:[{time:"üåÖ",title:"Palacio Real",detail:"Visita guiada",type:"tourism"},{time:"üåÜ",title:"Barrio de La Latina",detail:"Tapas y paseo",type:"food"}]},
  {date:"2026-06-09",label:"Martes 9",city:"Toledo",color:"#457b9d",icon:"‚öîÔ∏è",events:[{time:"üåÖ",title:"Excursi√≥n a Toledo",detail:"Tren AVE (~30 min)",type:"transport"},{time:"üïê",title:"Casco hist√≥rico",detail:"Catedral, Alc√°zar, calles medievales",type:"tourism"}]},
  {date:"2026-06-10",label:"Mi√©rcoles 10",city:"Toledo",color:"#457b9d",icon:"‚öîÔ∏è",events:[{time:"üåÖ",title:"Toledo d√≠a 2",detail:"Sinagoga, Museo del Greco, miradores",type:"tourism"},{time:"üåÜ",title:"Regreso a Madrid",detail:"Tren de vuelta",type:"transport"}]},
  {date:"2026-06-11",label:"Jueves 11",city:"Barcelona",color:"#1B3C8C",icon:"üåä",events:[{time:"üåÖ",title:"Viaje a Barcelona",detail:"Traslado y check-in Airbnb",type:"transport"},{time:"üåÜ",title:"Las Ramblas",detail:"Barrio G√≥tico, La Boquer√≠a",type:"tourism"}]},
  {date:"2026-06-12",label:"Viernes 12",city:"Barcelona",color:"#1B3C8C",icon:"üèéÔ∏è",events:[{time:"üèÅ",title:"F1 ‚Äî Pr√°ctica Libre",detail:"Circuit de Barcelona-Catalunya",type:"f1"}]},
  {date:"2026-06-13",label:"S√°bado 13",city:"Barcelona",color:"#1B3C8C",icon:"üèéÔ∏è",events:[{time:"üèÅ",title:"F1 ‚Äî Clasificaci√≥n",detail:"Circuit de Barcelona-Catalunya",type:"f1"}]},
  {date:"2026-06-14",label:"Domingo 14",city:"Barcelona",color:"#1B3C8C",icon:"üèéÔ∏è",events:[{time:"üèÅ",title:"F1 ‚Äî Carrera",detail:"Circuit de Barcelona-Catalunya",type:"f1"}]},
  {date:"2026-06-15",label:"Lunes 15",city:"Barcelona",color:"#1B3C8C",icon:"üåä",events:[{time:"üåÖ",title:"Sagrada Familia",detail:"Reservar entrada online",type:"tourism"},{time:"üåÜ",title:"Park G√ºell",detail:"Zona monumental de Gaud√≠",type:"tourism"}]},
  {date:"2026-06-16",label:"Martes 16",city:"Barcelona",color:"#1B3C8C",icon:"üåä",events:[{time:"üåÖ",title:"Barceloneta",detail:"Playa y paseo mar√≠timo",type:"tourism"},{time:"üåÜ",title:"Casa Batll√≥ / La Pedrera",detail:"Arquitectura de Gaud√≠",type:"tourism"}]},
  {date:"2026-06-17",label:"Mi√©rcoles 17",city:"Valencia",color:"#2a9d8f",icon:"üçä",events:[{time:"üåÖ",title:"Viaje a Valencia",detail:"Traslado desde Barcelona",type:"transport"},{time:"üåÜ",title:"Ciudad de las Artes y las Ciencias",detail:"Oceanogr√†fic, Hemisf√®ric",type:"tourism"}]},
  {date:"2026-06-18",label:"Jueves 18",city:"Valencia",color:"#2a9d8f",icon:"üçä",events:[{time:"üåÖ",title:"Centro hist√≥rico",detail:"Catedral, Lonja de la Seda, Mercado Central",type:"tourism"},{time:"üåÜ",title:"Playa de la Malvarrosa",detail:"Paella frente al mar",type:"food"}]},
  {date:"2026-06-19",label:"Viernes 19",city:"Madrid",color:"#D71920",icon:"üè∞",events:[{time:"üåÖ",title:"Regreso a Madrid",detail:"Traslado desde Valencia",type:"transport"},{time:"üåÜ",title:"√öltimas compras",detail:"Gran V√≠a, Malasa√±a, cena de despedida",type:"tourism"}]},
  {date:"2026-06-20",label:"S√°bado 20",city:"Vuelo",color:"#6366f1",icon:"‚úàÔ∏è",events:[{time:"06:50",title:"Vuelo a Montevideo",detail:"IB 169 ‚Äî Salida 6:50am",type:"flight"}]}
];
const CC={Madrid:"#D71920",Toledo:"#457b9d",Barcelona:"#1B3C8C",Valencia:"#2a9d8f",Vuelo:"#6366f1"};
const EI={flight:"‚úàÔ∏è",transport:"üöå",tourism:"üìç",food:"üçΩÔ∏è",f1:"üèéÔ∏è"};
const CTS=["Todos","Madrid","Toledo","Barcelona","Valencia"];

let S={data:JSON.parse(JSON.stringify(TRIP)),sel:null,add:false,modal:false,on:false,filt:"Todos"};
let db=null,ref=null;

const FC={apiKey:"AIzaSyDPZPk2nsOQ3oRMG7ADhS56zEFyORTE4QQ",authDomain:"flor-y-pato-trip.firebaseapp.com",databaseURL:"https://flor-y-pato-trip-default-rtdb.firebaseio.com",projectId:"flor-y-pato-trip",storageBucket:"flor-y-pato-trip.firebasestorage.app",messagingSenderId:"862498607498",appId:"1:862498607498:web:7e2ccf24cd913e6cb7c5c3"};

function initFB(){try{firebase.initializeApp(FC);db=firebase.database();ref=db.ref('trip-espana-2026');ref.on('value',s=>{const d=s.val();if(d&&Array.isArray(d)){S.data=d;S.on=true;R()}});db.ref('.info/connected').on('value',s=>{S.on=s.val()===true;R()});ref.once('value',s=>{if(!s.val())ref.set(TRIP)});return true}catch(e){return false}}
function save(){if(ref)ref.set(S.data)}
function tm(){const m={};S.data.forEach(d=>{m[d.date]=d});return m}

function cal(){
  const t=tm();let c='';
  for(let d=1;d<=30;d++){
    const ds=`2026-06-${String(d).padStart(2,'0')}`,td=t[ds],sl=S.sel===ds;
    if(td){const sh=S.filt==="Todos"||td.city===S.filt;
      c+=`<div class="cd t ${sl?'sel':''}" style="background:${td.color}${sl?'':'cc'}${!sh?';opacity:0.15':''}" onclick="sel('${ds}')">${d}<div class="dots">${td.events.map(()=>'<div class="dot"></div>').join('')}</div></div>`;
    }else c+=`<div class="cd x">${d}</div>`;
  }
  return c;
}

function R(){
  const t=tm(),sd=S.sel?t[S.sel]:null;
  const cnt={};S.data.forEach(d=>{if(d.city!=="Vuelo")cnt[d.city]=(cnt[d.city]||0)+1});
  const total=Object.values(cnt).reduce((a,b)=>a+b,0);
  let h='';

  if(db)h+=`<div class="sync ${S.on?'on':'off'}">${S.on?'‚óè Sincronizado':'‚óã Offline'}</div>`;

  // Header with Nacional shield
  h+=`<div class="header">
    <div class="header-inner">
      <div class="shield">${SHIELD_SVG}</div>
      <div class="header-text">
        <h1>Espa√±a <span class="yr">2026</span></h1>
        <div class="sub">5 ‚Äî 20 de Junio ¬∑ 16 d√≠as</div>
      </div>
      ${db?'<button class="share-btn" onclick="sM()">üîó</button>':''}
    </div>
    <div class="city-strip">${Object.entries(cnt).map(([c,n])=>
      `<div class="city-bar" style="flex:${n};background:${CC[c]}">${c}</div>`
    ).join('')}</div>
  </div>`;

  // Tabs
  h+=`<div class="tabs">${CTS.map(c=>`<button class="tab ${S.filt===c?'on':''}" onclick="flt('${c}')">${c}</button>`).join('')}</div>`;

  // Calendar
  h+=`<div class="cal-wrap"><div class="cal">
    <div class="cal-head"><div class="cal-dot"></div><div class="cal-month">Junio 2026</div><div class="cal-dot"></div></div>
    <div class="cal-wk">${['L','M','X','J','V','S','D'].map(d=>`<span>${d}</span>`).join('')}</div>
    <div class="cal-g">${cal()}</div>
  </div></div>`;

  // Detail or hint
  h+='<div class="det-wrap">';
  if(sd){
    h+=`<div class="det">
      <div class="det-banner" style="background:linear-gradient(135deg, ${sd.color}08, ${sd.color}04)">
        <div class="det-ico">${sd.icon}</div>
        <div class="det-info">
          <div class="det-name">${sd.label}</div>
          <span class="det-badge" style="background:${sd.color}">${sd.city}</span>
        </div>
      </div>
      <div class="evs">${sd.events.map((e,j)=>`
        ${j?'<div class="ev-sep"></div>':''}
        <div class="ev">
          <div class="ev-ic ${e.type}">${EI[e.type]||'üìç'}</div>
          <div class="ev-nfo"><div class="ev-t">${e.time}</div><div class="ev-n">${e.title}</div><div class="ev-d">${e.detail}</div></div>
          <button class="ev-x" onclick="del('${sd.date}',${j})">√ó</button>
        </div>`).join('')}</div>
      ${S.add?`<div class="add-f">
        <div class="fr"><input class="fi tm" id="nt" placeholder="Hora"><input class="fi" id="nn" placeholder="T√≠tulo"></div>
        <div class="fr"><input class="fi" id="nd" placeholder="Detalle"></div>
        <div class="fr"><select class="fs" id="ny"><option value="tourism">Turismo</option><option value="transport">Transporte</option><option value="food">Comida</option><option value="f1">F1</option><option value="flight">Vuelo</option></select></div>
        <div class="fa"><button class="btn-add" onclick="addE('${sd.date}')">Agregar</button><button class="btn-cancel" onclick="S.add=false;R()">Cancelar</button></div>
      </div>`:`<button class="add-b" onclick="S.add=true;R()">+ Agregar actividad</button>`}
    </div>`;
  }else{
    h+=`<div class="hint"><div class="hint-shield">${SHIELD_HINT}</div><div class="hint-t">Toc√° un d√≠a del calendario<br>para ver las actividades</div></div>`;
  }
  h+='</div>';

  if(S.modal){const u=location.href;
    h+=`<div class="mbg" onclick="cM()"><div class="msh" onclick="event.stopPropagation()">
      <h2>üîó Compartir</h2><p>Mand√°le este link a tu compa√±ero de viaje. Los cambios se sincronizan al instante.</p>
      <div class="sbox"><span>${u}</span><button class="cpb" onclick="cpL()">Copiar</button></div>
      <button class="clb" onclick="cM()">Cerrar</button>
    </div></div>`;
  }
  h+='<div class="spacer"></div>';
  document.getElementById('app').innerHTML=h;
}

function sel(d){S.sel=S.sel===d?null:d;S.add=false;R();if(S.sel)setTimeout(()=>{const e=document.querySelector('.det');if(e)e.scrollIntoView({behavior:'smooth',block:'nearest'})},60)}
function flt(c){S.filt=c;R()}
function del(d,i){const x=S.data.findIndex(t=>t.date===d);if(x>=0){S.data[x].events.splice(i,1);save();R()}}
function addE(d){const t=document.getElementById('nt').value||'üïê',n=document.getElementById('nn').value,de=document.getElementById('nd').value||'',ty=document.getElementById('ny').value;if(!n)return;const x=S.data.findIndex(t=>t.date===d);if(x>=0){S.data[x].events.push({time:t,title:n,detail:de,type:ty});S.add=false;save();R()}}
function sM(){S.modal=true;R()}
function cM(){S.modal=false;R()}
function cpL(){navigator.clipboard.writeText(location.href).then(()=>{const b=document.querySelector('.cpb');if(b){b.textContent='‚úì';setTimeout(()=>b.textContent='Copiar',1500)}})}

(function(){
  const ch=document.getElementById('checkered');
  if(ch){
    const cols=Math.ceil(window.innerWidth/12);
    for(let r=0;r<2;r++)for(let c=0;c<cols;c++){
      const s=document.createElement('span');
      s.style.background=(r+c)%2===0?'#fff':'#222';
      ch.appendChild(s);
    }
  }
  initFB();R();
  setTimeout(()=>{
    const sp=document.getElementById('splash');
    if(sp){sp.classList.add('hide');setTimeout(()=>sp.remove(),600);}
  },2600);
})();
</script>
</body>
</html>
